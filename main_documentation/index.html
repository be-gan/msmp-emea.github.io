
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive documentation for package msmp.emea">
      
      
        <meta name="author" content="Annalect EMEA">
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Main documentation - msmp.emea Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mmm-section" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="msmp.emea Documentation" class="md-header__button md-logo" aria-label="msmp.emea Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            msmp.emea Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Main documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="msmp.emea Documentation" class="md-nav__button md-logo" aria-label="msmp.emea Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    msmp.emea Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../modeling-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modeling Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mmm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MMM Workflow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../hd-mmm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HD MMM Workflow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Tools
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../function-help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Function Specific Help
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Materials
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Main documentation</h1>

<h2 id="mmm-section">MMM Section<a class="headerlink" href="#mmm-section" title="Permanent link">&para;</a></h2>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Marketing Mix Modeling (MMM) is a powerful analytical approach that helps businesses understand the impact of marketing activities on business outcomes. By analyzing data across multiple marketing channels, MMM helps you optimize marketing spend, predict future outcomes, and make data-driven decisions. </p>
<p>The <code>msmp.emea</code> R package provides a structured approach to perform MMM analysis with ease. It automates many of the key tasks required in an MMM analysis, such as data preparation, model estimation, and result interpretation.</p>
<p>With <code>msmp.emea</code>, analysts can:</p>
<ul>
<li><strong>Set Up Projects Easily</strong>: Automatically generate a structured project folder to keep analyses organized.</li>
<li><strong>Ingest and Clean Data</strong>: Read client data from various sources and apply essential preprocessing steps to make sure it's ready for analysis.</li>
<li><strong>Transform Data</strong>: Apply necessary transformations such as scaling, lagging, and feature engineering to prepare the data.</li>
<li><strong>Estimate Model Coefficients</strong>: Fit the MMM model to the data and extract key parameters for analysis.</li>
<li><strong>Decompose Results</strong>: Break down the contribution of each marketing channel for actionable insights.</li>
<li><strong>Calculate Response Curves</strong>: Understand diminishing returns and optimize media spend.</li>
<li><strong>Export and Save Results</strong>: Store results in structured formats for further analysis and reporting.</li>
</ul>
<p>This guide will walk you through the entire process of using the <code>msmp.emea</code> package to conduct MMM analysis. Whether you’re new to MMM or an experienced analyst, <code>msmp.emea</code> streamlines the process and helps you focus on interpreting results and driving strategic decisions.</p>
<h2 id="package-installation">Package Installation<a class="headerlink" href="#package-installation" title="Permanent link">&para;</a></h2>
<p>The first step is to install the <code>msmp.emea</code> package on your machine. Follow the steps below to install the package and verify that everything is set up correctly.</p>
<p>The <code>msmp.emea</code> package is hosted on <a href="https://bitbucket.org/omguk-annalect/msmp.emea/src/master/">Bitbucket</a>.</p>
<p>If you or your team need access, please contact us at <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#105;&#99;&#104;&#111;&#108;&#97;&#115;&#46;&#115;&#109;&#101;&#114;&#97;&#108;&#100;&#64;&#97;&#110;&#110;&#97;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;">&#110;&#105;&#99;&#104;&#111;&#108;&#97;&#115;&#46;&#115;&#109;&#101;&#114;&#97;&#108;&#100;&#64;&#97;&#110;&#110;&#97;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;</a>, <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#105;&#110;&#103;&#101;&#110;&#46;&#103;&#97;&#110;&#64;&#97;&#110;&#110;&#97;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;">&#98;&#105;&#110;&#103;&#101;&#110;&#46;&#103;&#97;&#110;&#64;&#97;&#110;&#110;&#97;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;</a>, or <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#103;&#105;&#117;&#115;&#101;&#112;&#112;&#101;&#46;&#110;&#105;&#99;&#111;&#108;&#101;&#116;&#116;&#105;&#64;&#97;&#110;&#110;&#97;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;">&#103;&#105;&#117;&#115;&#101;&#112;&#112;&#101;&#46;&#110;&#105;&#99;&#111;&#108;&#101;&#116;&#116;&#105;&#64;&#97;&#110;&#110;&#97;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;</a> to request repository permissions.</p>
<h3 id="authentication-requirements">Authentication requirements<a class="headerlink" href="#authentication-requirements" title="Permanent link">&para;</a></h3>
<p>To download the package from our private Bitbucket repository, you must authenticate your access. Please ensure the following:</p>
<ul>
<li>You have access to the Bitbucket repository.</li>
<li>You have created a Bitbucket App Password with the appropriate permissions (typically read access to repositories). This is required because Bitbucket no longer supports account passwords for Git operations.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Bitbucket Username</label><label for="__tabbed_1_2">App Password</label><label for="__tabbed_1_3">Pro-tip</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>How to Find Your Bitbucket Username:</p>
<ul>
<li>Log in to your Bitbucket account</li>
<li>Go to your <a href="https://bitbucket.org/account/settings/">Account settings</a> page</li>
<li>Under Bitbucket profile settings, look for the Username field — this is the username you'll use when authenticating with Git or installing packages.</li>
</ul>
</div>
<div class="tabbed-block">
<p>Creating a Bitbucket App Password:</p>
<ul>
<li>Log in to your Bitbucket account</li>
<li>Go to your <a href="https://bitbucket.org/account/settings/app-passwords/">App passowrds</a> page</li>
<li>Click Create app password.</li>
<li>Give it a label (e.g., “msmp.emea install”).</li>
<li>Select the minimum required permissions (usually under "Repositories" &gt; "Read").</li>
<li><strong>Save the password somewhere secure — you won't be able to see it again</strong>.</li>
</ul>
</div>
<div class="tabbed-block">
<p>To avoid re-entering your Bitbucket username and password each time, you can store them securely in your local <code>.Rprofile</code> so they’re automatically loaded into your R environment.</p>
</div>
</div>
</div>
<p>Step-by-step instructions:</p>
<ul>
<li><strong>Open your</strong> <code>.Rprofile</code> by running the following command in your R console:</li>
</ul>
<div class="highlight"><pre><span></span><code>usethis::edit_r_profile()
</code></pre></div>
<ul>
<li><strong>Paste the following lines into the file</strong>, replacing the placeholders with your actual Bitbucket username and password:</li>
</ul>
<div class="highlight"><pre><span></span><code># Set Bitbucket credentials (replace with your actual username and password)
options(bitbucket_user = &quot;my_bitbucket_user&quot;)
options(bitbucket_pass = &quot;my_bitbucket_password&quot;)

# Automatically load credentials into your environment
bitbucket_user &lt;- getOption(&quot;bitbucket_user&quot;)
bitbucket_pass &lt;- getOption(&quot;bitbucket_pass&quot;)
</code></pre></div>
<ul>
<li><strong>Save the file and restart your R session</strong> to apply the changes.
Note: This method stores your credentials in plain text. </li>
</ul>
<h3 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h3>
<p>Before installing the <code>msmp.emea</code> package, make sure the following dependencies are available on your machine:</p>
<ul>
<li><code>devtools</code>: This package is required to install packages directly from Git repositories (like Bitbucket).</li>
</ul>
<p>You can install it from CRAN using:</p>
<div class="highlight"><pre><span></span><code>install.packages(&quot;devtools&quot;)
</code></pre></div>
<h4 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">System dependencies</label><label for="__tabbed_2_2">Windows users</label><label for="__tabbed_2_3">macOS users </label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Note: <code>devtools</code> itself has several system-level dependencies (e.g., Rtools on Windows or Xcode on macOS). Make sure these are installed if you run into errors during installation.</p>
</div>
<div class="tabbed-block">
<p>Before installing the package, it's important to set the download method to "wininet" to avoid potential issues with downloading files. This method is specifically designed for compatibility with Windows and can help prevent common errors related to internet connectivity or HTTPS certificate validation.
Please run the following command in your R session <strong>before</strong> installing the package:</p>
<div class="highlight"><pre><span></span><code>options(download.file.method = &quot;wininet&quot;)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>In most cases, no additional setup is needed before installing packages. However, if you encounter issues with package downloads—especially related to HTTPS or certificates—you can explicitly set the download method to "libcurl", which is well-supported on macOS.</p>
<p>To do this, run the following command <strong>before</strong> installing the package:</p>
<div class="highlight"><pre><span></span><code>options(download.file.method = &quot;libcurl&quot;)
</code></pre></div>
<p>This can help ensure stable and secure downloads using the system's native networking libraries.</p>
</div>
</div>
</div>
<h3 id="installation-type">Installation type<a class="headerlink" href="#installation-type" title="Permanent link">&para;</a></h3>
<p>You may be installing the <code>msmp.emea</code> package for the first time, or updating an existing installation to ensure you’re using the latest version. Follow the appropriate instructions below.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Fresh install</label><label for="__tabbed_3_2">Update</label><label for="__tabbed_3_3">Beta Testers</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Use this option if you’re installing the package for the first time:</p>
<div class="highlight"><pre><span></span><code>remotes::install_bitbucket(
  repo = &quot;omguk-annalect/msmp.emea&quot;, 
  auth_user = bitbucket_user, 
  password = bitbucket_pass)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>If you already have the package installed and want to update it:</p>
<ul>
<li>First, uninstall the existing version:</li>
</ul>
<div class="highlight"><pre><span></span><code>remove.packages(&quot;msmp.emea&quot;)
</code></pre></div>
<ul>
<li>Restart your R session to clear any locked namespace.</li>
<li>Reinstall the latest version from Bitbucket:</li>
</ul>
<div class="highlight"><pre><span></span><code>remotes::install_bitbucket(
  repo = &quot;omguk-annalect/msmp.emea&quot;, 
  auth_user = bitbucket_user, 
  password = bitbucket_pass)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>This section is intended for <strong>advanced users or testers</strong> who need to install a specific development version of the package.</p>
<p>If you need to install a version from a branch other than master, or from a specific commit (e.g., to test changes), you can use the ref argument in the remotes::install_bitbucket() function:</p>
<div class="highlight"><pre><span></span><code>remotes::install_bitbucket(
  repo = &quot;omguk-annalect/msmp.emea&quot;,
  ref = &quot;branch-name-or-commit-hash&quot;,
  auth_user = bitbucket_user,
  password  = bitbucket_pass
)
</code></pre></div>
<p>Replace "branch-name-or-commit-hash" with the name of the development branch (e.g., "dev-feature-x") or a specific commit SHA (e.g., "9f8c3a2d4e").</p>
</div>
</div>
</div>
<h3 id="check-installation-and-version">Check Installation and Version<a class="headerlink" href="#check-installation-and-version" title="Permanent link">&para;</a></h3>
<p>After loading the package, run the following to confirm the version installed:</p>
<div class="highlight"><pre><span></span><code>library(msmp.emea)
packageVersion(&quot;msmp.emea&quot;)
</code></pre></div>
<p>If the output shows the expected version number (e.g., v0.61.3), the installation was successful.</p>
<h2 id="data-structure">Data Structure<a class="headerlink" href="#data-structure" title="Permanent link">&para;</a></h2>
<p>Before diving into model workflow, it's important to clarify how data should be structured, as this affects how the package processes inputs and ensures consistent behavior across different types of datasets — whether panel or non-panel.</p>
<h3 id="panel-vs-non-panel-data">Panel vs. Non-Panel Data<a class="headerlink" href="#panel-vs-non-panel-data" title="Permanent link">&para;</a></h3>
<p>In the context of Marketing Mix Modeling (MMM), <strong>panel data</strong> refers to datasets that contain observations <strong>across multiple units</strong> (such as regions, brands, or stores) over time. Each unit has its own time series, allowing analysts to capture both temporal dynamics and cross-sectional variation. 
This can improve model robustness by leveraging patterns across similar entities and supporting more generalizable insights.</p>
<p>By contrast, <strong>non-panel data</strong> (also known as time series or aggregate data) includes <strong>a single stream of observations over time</strong>, typically representing national-level performance or a single entity. </p>
<p>While simpler to manage, non-panel data limits the ability to control for unit-specific effects and can lead to more fragile estimates if the dataset is small or noisy.</p>
<table>
  <thead>
    <tr>
      <th>Date</th>
      <th style="background-color: #ffff88;">Car Model</th>
      <th>Orders</th>
      <th>TV Spend</th>
      <th>Radio Spend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2022-01-01</td>
      <td style="background-color: #ffff88;">Alpha</td>
      <td>91</td>
      <td>872.13</td>
      <td>2916.01</td>
    </tr>
    <tr>
      <td>2022-01-01</td>
      <td style="background-color: #ffff88;">Beta</td>
      <td>154</td>
      <td>2412.97</td>
      <td>3266.66</td>
    </tr>
    <tr>
      <td>2022-01-01</td>
      <td style="background-color: #ffff88;">Delta</td>
      <td>115</td>
      <td>3973.21</td>
      <td>1752.63</td>
    </tr>
    <tr>
      <td>2022-01-01</td>
      <td style="background-color: #ffff88;">Gamma</td>
      <td>96</td>
      <td>175.27</td>
      <td>4847.49</td>
    </tr>
    <tr>
      <td>2022-01-08</td>
      <td style="background-color: #ffff88;">Alpha</td>
      <td>71</td>
      <td>7417.53</td>
      <td>3864.92</td>
    </tr>
    <tr>
      <td>2022-01-08</td>
      <td style="background-color: #ffff88;">Beta</td>
      <td>151</td>
      <td>1462.11</td>
      <td>1039.69</td>
    </tr>
    <tr>
      <td>2022-01-08</td>
      <td style="background-color: #ffff88;">Delta</td>
      <td>165</td>
      <td>3163.78</td>
      <td>3402.06</td>
    </tr>
    <tr>
      <td>2022-01-08</td>
      <td style="background-color: #ffff88;">Gamma</td>
      <td>78</td>
      <td>9267.57</td>
      <td>2904.78</td>
    </tr>
    <tr>
      <td>2022-01-15</td>
      <td style="background-color: #ffff88;">Alpha</td>
      <td>107</td>
      <td>9244.82</td>
      <td>2923.08</td>
    </tr>
    <tr>
      <td>2022-01-15</td>
      <td style="background-color: #ffff88;">Beta</td>
      <td>91</td>
      <td>2707.85</td>
      <td>4926.91</td>
    </tr>
  </tbody>
</table>

<p style="font-size: 0.9em; color: #555; margin-top: 0.5em;">
  <em>Note:</em> <span style="background-color: #ffff88; padding: 0 0.3em;">Car Model</span> is the panel identifier used to group data by vehicle type.
</p>

<h3 id="why-use-a-panel-format">Why Use a Panel Format<a class="headerlink" href="#why-use-a-panel-format" title="Permanent link">&para;</a></h3>
<p>Our modeling approach standardizes how data is treated by <strong>assuming a panel structure for all input datasets</strong>. This provides consistency in how models are built, regardless of the original data format. </p>
<p>If a dataset is not naturally a panel (i.e., it contains only a single time series), <strong>we automatically add a grouping column to create a "panel of one"</strong>. This ensures that all processing and modeling routines — such as decomposition, contribution analysis, and cross-validation — can be applied uniformly, without needing special handling for different data types.</p>
<table>
  <thead>
    <tr>
      <th>Date</th>
      <th style="background-color: #ccffcc;">Panel Col</th>
      <th>Orders</th>
      <th>TV Spend</th>
      <th>Radio Spend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2022-01-01</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>151</td>
      <td>3550.62</td>
      <td>4911.53</td>
    </tr>
    <tr>
      <td>2022-01-08</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>129</td>
      <td>5245.67</td>
      <td>2383.74</td>
    </tr>
    <tr>
      <td>2022-01-15</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>103</td>
      <td>9522.32</td>
      <td>1516.49</td>
    </tr>
    <tr>
      <td>2022-01-22</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>151</td>
      <td>7284.52</td>
      <td>4516.02</td>
    </tr>
    <tr>
      <td>2022-01-29</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>150</td>
      <td>6993.12</td>
      <td>4187.69</td>
    </tr>
    <tr>
      <td>2022-02-05</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>111</td>
      <td>5301.55</td>
      <td>1624.52</td>
    </tr>
    <tr>
      <td>2022-02-12</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>125</td>
      <td>8073.22</td>
      <td>4493.61</td>
    </tr>
    <tr>
      <td>2022-02-19</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>155</td>
      <td>2835.41</td>
      <td>1832.87</td>
    </tr>
    <tr>
      <td>2022-02-26</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>109</td>
      <td>8590.96</td>
      <td>4512.57</td>
    </tr>
    <tr>
      <td>2022-03-04</td>
      <td style="background-color: #ccffcc;">client_name</td>
      <td>143</td>
      <td>826.44</td>
      <td>2390.48</td>
    </tr>
  </tbody>
</table>

<p style="font-size: 0.9em; color: #555; margin-top: 0.5em;">
  <em>Note:</em> <span style="background-color: #ccffcc; padding: 0 0.3em;">Panel Col</span> identifies groups when panel structure is required. If the data isn't in panel format, this will be generated automatically.
</p>

<h3 id="advantages-of-a-unified-approach">Advantages of a Unified Approach<a class="headerlink" href="#advantages-of-a-unified-approach" title="Permanent link">&para;</a></h3>
<p><strong>Treating all datasets as panels simplifies the architecture and improves model scalability</strong>. It allows us to apply the same logic for feature engineering, constraints, and optimization routines — whether the user provides a multi-brand dataset or a single-country time series. </p>
<p>This also makes it easier to expand to true panel use cases in the future, as the underlying structure already supports multiple groups. </p>
<h2 id="folders-setup">Folders Setup<a class="headerlink" href="#folders-setup" title="Permanent link">&para;</a></h2>
<p>This is the initial phase where (in your workflow template) you define the modeling scope, select the business KPIs (e.g., revenue, conversions), and determine the modeling granularity (e.g., weekly, country-level). The workflow will guide you to create a project folder structure and set configuration files or paths for your inputs and outputs.</p>
<p>Once you run the <code>project_init()</code> function, a new folder structure will be created on your machine. This structure is designed to help organize your data and outputs so that the package can easily access the files it needs to run the analysis.</p>
<h3 id="folders-and-file-overview">Folders and File Overview<a class="headerlink" href="#folders-and-file-overview" title="Permanent link">&para;</a></h3>
<p>The following files and folders are automatically created by the package during project initialization. They provide a standardized structure to support a smooth and reproducible modeling workflow.</p>
<p><img alt="Folder structure" src="../images/folderstruct.svg" /></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:7"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><input id="__tabbed_4_4" name="__tabbed_4" type="radio" /><input id="__tabbed_4_5" name="__tabbed_4" type="radio" /><input id="__tabbed_4_6" name="__tabbed_4" type="radio" /><input id="__tabbed_4_7" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">01_data</label><label for="__tabbed_4_2">02_eda</label><label for="__tabbed_4_3">03_model_workflow</label><label for="__tabbed_4_4">04_model_settings </label><label for="__tabbed_4_5">05_model_output</label><label for="__tabbed_4_6">06_documentation</label><label for="__tabbed_4_7">model_id.txt</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>This folder contains all raw and pre-processed input data used in the modeling process. This may include media spend, sales or conversions, control variables (e.g., pricing, promo), seasonal flags, and any other relevant time-series data. Ideally, files here are versioned and read-only, ensuring consistency across runs.</p>
</div>
<div class="tabbed-block">
<p>The Exploratory Data Analysis (EDA) folder holds visualizations, summary statistics, and diagnostics used to understand and validate the input data before modeling.</p>
<p><em>Note: this feature is still under development</em></p>
</div>
<div class="tabbed-block">
<p>This folder contains a copy of the main R markdowns that run the modeling pipeline. These scripts handle tasks such as initializing the model object, setting up the model, transforming variables, running the estimation, and generating outputs. Think of this as the "engine room" of your workflow.</p>
</div>
<div class="tabbed-block">
<p>This folder stores configuration files (mostly .CSV) that define model inputs and hyperparameters. These settings include which variables are included, prior distributions, transformation settings (e.g., adstock, saturation), and modeling time windows. </p>
<h5 id="input-files">Input Files<a class="headerlink" href="#input-files" title="Permanent link">&para;</a></h5>
<p>These are the key files you'll interact with throughout the modeling phase. They form the foundation of the workflow, guiding what data will be transformed, analyzed, and ultimately modeled.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Model Setup File</label><label for="__tabbed_5_2">Variables File</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The <strong>Model Setup</strong> file is the first configuration you'll edit when starting your analysis. It defines key parameters that control how the model is structured and what data is used. These settings guide both model estimation and response curve analysis.</p>
<p><strong>This file is essential for configuring your analysis and should be carefully reviewed and updated before running any model.</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Explanation</th>
<th style="text-align: left;">Mandatory_Field</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">ModelForm</td>
<td style="text-align: left;">Specifies the regression model form. Options include 'lin_lin' (linear), 'log_lin' (log-transformed response), and 'mc_lin' (mean-centered transformed response).</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">Panel</td>
<td style="text-align: left;">Indicates whether the model supports panel data structure. Set to 'Y' to ensure compatibility, even for non-panel use cases.</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">Time</td>
<td style="text-align: left;">Name of the time-related column in the dataset, typically representing months or weeks.</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">Geo</td>
<td style="text-align: left;">Not currently in use.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">CS</td>
<td style="text-align: left;">Defines the main cross-sectional unit used in panel models (e.g., product, market, or vehicle).</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">CS2</td>
<td style="text-align: left;">Optional second-level cross-sectional identifier (not currently available)</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">BeginDate</td>
<td style="text-align: left;">Start date for the analysis period. Format should be DD/MM/YYYY.</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">EndDate</td>
<td style="text-align: left;">End date for the analysis period. Format should be DD/MM/YYYY.</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">numSubModel</td>
<td style="text-align: left;">Optional. Specifies how many sub-models are linked to the main model.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">Submodel_Link1</td>
<td style="text-align: left;">Name of the parent variable in the main model used to link to the first sub-model.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">Submodel_Link2</td>
<td style="text-align: left;">Name of the parent variable used to link to the second sub-model.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">Submodel_Link3</td>
<td style="text-align: left;">Name of the parent variable used to link to the third sub-model.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">subModel1</td>
<td style="text-align: left;">Name or label of the first child sub-model to be used in hierarchical modeling.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">subModel2</td>
<td style="text-align: left;">Name or label of the second child sub-model to be used in hierarchical modeling.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">subModel3</td>
<td style="text-align: left;">Name or label of the third child sub-model to be used in hierarchical modeling.</td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;">SimStart</td>
<td style="text-align: left;">Start date for the simulation period used in response curve generation. Format: DD/MM/YYYY.</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">SimEnd</td>
<td style="text-align: left;">End date for the simulation period used in response curve generation. Format: DD/MM/YYYY.</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;">Mroi</td>
<td style="text-align: left;">Increment size used to simulate changes in media investment when generating response curves.</td>
<td style="text-align: left;">Yes</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p>The <strong>Variables</strong> file defines all variables used in the model along with their inclusion status and transformation settings. This file gives you full control over how each variable is treated in the modeling pipeline.</p>
<p><strong>This file is critical for customizing model inputs and ensuring each variable is preprocessed appropriately for the analysis.</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Column_Name</th>
<th style="text-align: left;">Explanation</th>
<th style="text-align: left;">Workflow_Component</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Orig_Variable</td>
<td style="text-align: left;">Original name of the variable as it appears in the raw dataset</td>
<td style="text-align: left;">All functions</td>
</tr>
<tr>
<td style="text-align: left;">Trans_Variable</td>
<td style="text-align: left;">Name to use for the variable after any transformation</td>
<td style="text-align: left;">All functions</td>
</tr>
<tr>
<td style="text-align: left;">AggregateVariable</td>
<td style="text-align: left;">Indicates a grouping variable for aggregating similar sub-variables</td>
<td style="text-align: left;">Decomposition</td>
</tr>
<tr>
<td style="text-align: left;">Variable_Type</td>
<td style="text-align: left;">Specifies the type of variable (e.g., Dependent, Trend, Default)</td>
<td style="text-align: left;">Decomposition</td>
</tr>
<tr>
<td style="text-align: left;">Include</td>
<td style="text-align: left;">Binary flag (1/0) indicating if the variable should be included in the model</td>
<td style="text-align: left;">All functions</td>
</tr>
<tr>
<td style="text-align: left;">VaryBy</td>
<td style="text-align: left;">Specifies if the variable coefficient varies by a grouping (only for panel data)</td>
<td style="text-align: left;">Coefficients estimation</td>
</tr>
<tr>
<td style="text-align: left;">Transform</td>
<td style="text-align: left;">Whether the variable should be transformed (Y/N) - Keep this as default.</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">TransformType</td>
<td style="text-align: left;">Type of transformation (e.g., adstock, log, lag, saturation)</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Lag</td>
<td style="text-align: left;">Number of periods to lag the variable</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Scale</td>
<td style="text-align: left;">Scaling factor to adjust the variable values</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Effective</td>
<td style="text-align: left;">Ad Response transformation (tbd)</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Recency</td>
<td style="text-align: left;">Ad Response transformation (tbd)</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Decay</td>
<td style="text-align: left;">Decay rate for adstock or adr (value between 0 and 1; a higher value means faster decay).</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Period</td>
<td style="text-align: left;">Ad Response transformation (tbd)</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Window</td>
<td style="text-align: left;">Size of the moving window (e.g., for rolling averages)</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Trim</td>
<td style="text-align: left;">Currently not in use</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Length</td>
<td style="text-align: left;">Maximum number of time periods over which advertising memory can persist.</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Peak</td>
<td style="text-align: left;">Indicates the peak point in a adstock transformation.</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">AT_Divisor</td>
<td style="text-align: left;">Arc-Tangent parameter (rarely used)</td>
<td style="text-align: left;">Transform (for diminising returns)</td>
</tr>
<tr>
<td style="text-align: left;">NE_Divisor</td>
<td style="text-align: left;">Negative Exponential parameter (rarely used)</td>
<td style="text-align: left;">Transform (for diminising returns)</td>
</tr>
<tr>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Ceiling of ABC curve (keep as 1)</td>
<td style="text-align: left;">Transform (for diminising returns)</td>
</tr>
<tr>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Parameter of ABC curve (typically set between 20–80% of the variable’s maximum value.)</td>
<td style="text-align: left;">Transform (for diminising returns)</td>
</tr>
<tr>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Parameter of ABC curve (If c &gt; -1, the function is logarithmic; if c &lt; -1, the function follows an S-shaped curve).</td>
<td style="text-align: left;">Transform (for diminising returns)</td>
</tr>
<tr>
<td style="text-align: left;">Max_Grps</td>
<td style="text-align: left;">Not in use</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">Prior_Mean</td>
<td style="text-align: left;">Prior mean for Bayesian estimation</td>
<td style="text-align: left;">Coefficients estimation</td>
</tr>
<tr>
<td style="text-align: left;">Prior_SD</td>
<td style="text-align: left;">Prior standard deviation for Bayesian estimation</td>
<td style="text-align: left;">Coefficients estimation</td>
</tr>
<tr>
<td style="text-align: left;">PriorSD_Adj</td>
<td style="text-align: left;">Adjustment factor for prior standard deviation</td>
<td style="text-align: left;">Coefficients estimation</td>
</tr>
<tr>
<td style="text-align: left;">Sign</td>
<td style="text-align: left;">Not in use</td>
<td style="text-align: left;">nan</td>
</tr>
<tr>
<td style="text-align: left;">Override</td>
<td style="text-align: left;">Not in use</td>
<td style="text-align: left;">nan</td>
</tr>
<tr>
<td style="text-align: left;">Simulate</td>
<td style="text-align: left;">Indicates if the variable is used for response curves</td>
<td style="text-align: left;">Response Curve</td>
</tr>
<tr>
<td style="text-align: left;">RC_Shape</td>
<td style="text-align: left;">Defines the shape of the response curve for the variable</td>
<td style="text-align: left;">Response Curve</td>
</tr>
<tr>
<td style="text-align: left;">Explore_correlation</td>
<td style="text-align: left;">Whether to include the variable in correlation diagnostics</td>
<td style="text-align: left;">EDA</td>
</tr>
<tr>
<td style="text-align: left;">Explore_transformation</td>
<td style="text-align: left;">Whether to explore alternate transformations during modeling</td>
<td style="text-align: left;">EDA</td>
</tr>
<tr>
<td style="text-align: left;">Spent_Variable</td>
<td style="text-align: left;">Reference to the spend version of the variable (if separated from exposure)</td>
<td style="text-align: left;">Response Curve</td>
</tr>
<tr>
<td style="text-align: left;">Cost_per_unit</td>
<td style="text-align: left;">Unit cost of the media (used in efficiency calculations)</td>
<td style="text-align: left;">Response Curve</td>
</tr>
<tr>
<td style="text-align: left;">Source</td>
<td style="text-align: left;">Metadata field indicating where the variable came from</td>
<td style="text-align: left;">Transformation</td>
</tr>
<tr>
<td style="text-align: left;">TimeUnit</td>
<td style="text-align: left;">Time granularity of the variable (e.g., weekly, monthly)</td>
<td style="text-align: left;">Transformation</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<p>This folder captures all outputs generated by the model, such as contribution decompositions, model diagnostics, or a copy of the model object. It may also include visual reports or summary tables. Outputs here are often used to support stakeholder decision-making.</p>
</div>
<div class="tabbed-block">
<p>This folder is created for the users to store documentation about the project: modeling rationale, decisions, assumptions, meeting notes, and final deliverables. It might also contain markdown files, slide decks, or PDFs that explain the project flow, outcomes, and business recommendations.</p>
</div>
<div class="tabbed-block">
<p>This file contains a unique identifier for the model run. It helps track and reference a specific set of modeling configurations, inputs, and outputs, especially in workflows that involve multiple iterations or parallel experiments.</p>
<p>The <code>model_id.txt</code> file typically includes a short string that is automatically generated by the pipeline.</p>
<p>Why it's important:</p>
<ul>
<li>Ensures traceability between model inputs and outputs.</li>
<li>Allows consistent naming of output files.</li>
<li>Makes collaboration easier by giving analysts a common reference point.</li>
</ul>
<p>Typical usage in the pipeline:</p>
<ul>
<li>Read in during model initialization to tag outputs.</li>
<li>Stored alongside outputs and logs.</li>
</ul>
</div>
</div>
</div>
<h2 id="modeling-workflow">Modeling Workflow<a class="headerlink" href="#modeling-workflow" title="Permanent link">&para;</a></h2>
<p>Our workflows are designed to ensure consistency, transparency, and reproducibility across projects.</p>
<p>The <code>msmp.emea</code> package supports two distinct yet complementary approaches for analyzing media effectiveness: a <strong>Bayesian Marketing Mix Modeling (Bayesian MMM)</strong> approach and a more granular <strong>High-Definition (HD)</strong> modeling approach. Both share a common foundation but are designed to answer different types of business questions.</p>
<h3 id="overview-of-modeling-approaches">Overview of Modeling Approaches<a class="headerlink" href="#overview-of-modeling-approaches" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Bayesian MMM</label><label for="__tabbed_6_2">High-Definition (HD) Modeling</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The <strong>Bayesian MMM</strong> approach is a modern version of the classical Marketing Mix Modeling framework, implemented using Bayesian inference. This method enables the quantification of media effectiveness and ROI while explicitly accounting for uncertainty in parameter estimates.</p>
<p>Key characteristics of the Bayesian MMM approach:</p>
<ul>
<li><strong>Prior knowledge incorporation</strong>: Prior distributions can be used to incorporate historical learnings or domain expertise into the model.</li>
<li><strong>Flexibility</strong>: The Bayesian framework supports complex modeling features such as hierarchical structures, seasonality components, and non-linear saturation effects.</li>
</ul>
<p>This approach is ideal when the goal is to build robust, interpretable models with quantified uncertainty and leverage prior knowledge to stabilize estimates in data-scarce environments.</p>
</div>
<div class="tabbed-block">
<p><strong>HD MMM</strong> is a build on top of the current MMM toolkit where you would be able to take a more detailed look into the contributions of your total media channel. For example, two main strategies were used for a digital channel - <strong>strategy A</strong> and <strong>strategy B</strong>. </p>
<p>The HD algorithm will then be able to approximate the effectiveness of each strategy based on the flighting pattern and give you a breakdown of each strategy's contribution that makes up the total digital channel's contribution in the MMM model.</p>
</div>
</div>
</div>
<h3 id="workflow">Workflow<a class="headerlink" href="#workflow" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Bayesian MMM</label><label for="__tabbed_7_2">High-Definition (HD) Modeling</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="MMM Workflow" src="../images/mmm_workflow.svg" />    </p>
</div>
<div class="tabbed-block">
<p><img alt="HD MMM Workflow" src="../images/hd_mmm_workflow.svg" />    </p>
</div>
</div>
</div>
<h3 id="workflow-templates">Workflow Templates<a class="headerlink" href="#workflow-templates" title="Permanent link">&para;</a></h3>
<p>The <code>msmp.emea</code> package includes a set of predefined workflow templates designed to guide you through the media modeling process. These templates are accessible directly from RStudio, helping ensure a standardized, efficient, and reproducible workflow.</p>
<h4 id="available-templates">Available Templates<a class="headerlink" href="#available-templates" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Model-Workflow</strong>: A standard template for running a complete MMM analysis.</li>
<li><strong>HD-MMM</strong>: A template for Hierarchical Decomposition modeling, enabling granular analysis within channels.</li>
<li><strong>Unnest-Models</strong>: A utility template for unnesting models and analyzing their individual components.</li>
</ul>
<p>These templates streamline your workflow by reducing setup time, minimizing the risk of error, and ensuring all critical steps are included.</p>
<h4 id="how-to-use-templates-in-rstudio">How to Use Templates in RStudio<a class="headerlink" href="#how-to-use-templates-in-rstudio" title="Permanent link">&para;</a></h4>
<p>To launch a template in RStudio:</p>
<ul>
<li>Click on the <em>New File</em> icon.</li>
<li>Select <em>R Markdown</em>.</li>
<li>Choose <em>From Template</em>, then pick the relevant <code>msmp.emea</code> template.</li>
</ul>
<p>RStudio will create a new document pre-filled with the appropriate structure, guidance, and placeholders to help you get started quickly.</p>
<h2 id="detailed-procedure">Detailed Procedure<a class="headerlink" href="#detailed-procedure" title="Permanent link">&para;</a></h2>
<h3 id="load-and-clean-data">Load and clean data<a class="headerlink" href="#load-and-clean-data" title="Permanent link">&para;</a></h3>
<p>In this step, raw data sources (media, sales, promotions, seasonality, etc.) are loaded and pre-processed. You’ll standardize column formats, handle missing values, align time series, and possibly merge disparate datasets to create a unified modeling dataset.</p>
<h3 id="model-object">Model object<a class="headerlink" href="#model-object" title="Permanent link">&para;</a></h3>
<p>You create the base model object using the <code>msmp.emea</code> functions. This object acts as the container for all subsequent modeling steps and configurations. It typically includes raw input data, metadata, and placeholder slots for transformed data, priors, and model outputs.</p>
<h3 id="model-setup">Model setup<a class="headerlink" href="#model-setup" title="Permanent link">&para;</a></h3>
<p>Here, you define modeling parameters such as the dependent variable (target), media channels, control variables, time windows, and holiday effects. This is where the modeling framework is initialized — effectively “telling” the model what to expect.</p>
<h3 id="model-specification">Model specification<a class="headerlink" href="#model-specification" title="Permanent link">&para;</a></h3>
<p>Also referred to as "model spec," this step involves defining how variables enter the model: what transformations are applied (e.g., adstock, saturation), which priors are used in Bayesian estimation, and whether interactions or groupings are introduced. It’s a critical step that shapes the econometric assumptions.</p>
<h3 id="data-transformation-and-validation">Data Transformation and Validation<a class="headerlink" href="#data-transformation-and-validation" title="Permanent link">&para;</a></h3>
<p>At this stage, data is transformed according to the model spec: media variables may be adstocked, logged, or saturated. You also perform validation checks to ensure data aligns with model assumptions (e.g., no missing data, consistent timeframes).</p>
<h3 id="run-model">Run Model<a class="headerlink" href="#run-model" title="Permanent link">&para;</a></h3>
<p>You fit the model using the inference engine provided in <code>msmp.emea</code>. This step will also provide diagnostics for results inspection. You may iterate multiple times, adjusting specifications or priors based on initial results.</p>
<h3 id="decomposition">Decomposition<a class="headerlink" href="#decomposition" title="Permanent link">&para;</a></h3>
<p>Here you decompose the predicted values into contributions from each variable or group of variables (e.g., media, price, promotions). This allows you to understand what’s driving performance and quantify the ROI of each input.</p>
<h3 id="response-curves">Response Curves<a class="headerlink" href="#response-curves" title="Permanent link">&para;</a></h3>
<p>Response curves (a.k.a. saturation curves) show how the output responds to incremental changes in each media variable. These are essential for budget planning and optimization, helping identify diminishing returns and efficient spend thresholds.</p>
<h2 id="supported-transformations">Supported Transformations<a class="headerlink" href="#supported-transformations" title="Permanent link">&para;</a></h2>
<p>The <code>msmp.emea</code> package supports several transformations to handle data in ways that optimize the MMM process. Some of the key transformation types are:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">TransformType</th>
<th style="text-align: left;">Caller</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">adstockv3</td>
<td style="text-align: left;">Adstock</td>
<td style="text-align: left;">Applies a standard adstock transformation to model lagged and decaying media effects.</td>
</tr>
<tr>
<td style="text-align: left;">adstockv4imp</td>
<td style="text-align: left;">Adstock with rescaled impressions</td>
<td style="text-align: left;">Similar to standard adstock but used for impression data, applying rescaling to account for volume.</td>
</tr>
<tr>
<td style="text-align: left;">adr</td>
<td style="text-align: left;">Ad response</td>
<td style="text-align: left;">Applies an advertising response function, typically used for modeling non-linear saturation effects.</td>
</tr>
<tr>
<td style="text-align: left;">lag</td>
<td style="text-align: left;">Lag</td>
<td style="text-align: left;">Shifts the variable backward in time to capture delayed effects.</td>
</tr>
<tr>
<td style="text-align: left;">log</td>
<td style="text-align: left;">Log</td>
<td style="text-align: left;">Applies a logarithmic transformation to reduce skew and stabilize variance.</td>
</tr>
<tr>
<td style="text-align: left;">ma</td>
<td style="text-align: left;">Moving average</td>
<td style="text-align: left;">Smooths the variable by averaging over a specified time window to reduce noise.</td>
</tr>
<tr>
<td style="text-align: left;">abcnew</td>
<td style="text-align: left;">For diminishing returns</td>
<td style="text-align: left;">Applies a functional form tailored for diminishing returns (e.g., sigmoid or Hill-type curves).</td>
</tr>
<tr>
<td style="text-align: left;">none</td>
<td style="text-align: left;">No transformation</td>
<td style="text-align: left;">Leaves the variable untransformed. Use when no preprocessing is required.</td>
</tr>
<tr>
<td style="text-align: left;">customt()</td>
<td style="text-align: left;">Custom transformation</td>
<td style="text-align: left;">Applies a user-defined transformation using a formula-like string. For example, customt("x^2") squares the input."</td>
</tr>
<tr>
<td style="text-align: left;">boxcox</td>
<td style="text-align: left;">Boxcox</td>
<td style="text-align: left;">Applies a Box-Cox transformation to stabilize variance and approximate normality.</td>
</tr>
</tbody>
</table>
<p><strong>The <code>Transform</code> function allows you to apply multiple transformations by chaining them together using underscores (_). Each TransformType will be applied in the order specified, from left to right.</strong></p>
<h2 id="advanced-tools">Advanced Tools<a class="headerlink" href="#advanced-tools" title="Permanent link">&para;</a></h2>
<p>The features described in this section go beyond the core <code>msmp.emea</code> workflow. </p>
<p>While they are not required for the standard analysis pipeline, they are designed to support analysts who need greater flexibility or advanced functionality when processing and modeling data. </p>
<p>These tools aim to streamline common tasks, handle edge cases, and provide more control over specific steps in the modeling process, ultimately making the overall workflow more adaptable to different analytical needs.</p>
<h3 id="new_ga">new_ga<a class="headerlink" href="#new_ga" title="Permanent link">&para;</a></h3>
<p>The <code>msmp.emea</code> package includes a function called <code>new_ga</code> that runs a genetic algorithm (GA) to <strong>find the best parameter values</strong> for a model simulation. It works by testing many different combinations of parameters and selecting those that lead to better simulation results, based on a score defined by the user. </p>
<p>The goal is to <strong>maximize</strong> this score, so the function keeps improving the parameter sets over several generations. It automatically filters out poor or invalid solutions, applies any constraints set by the user, and ensures that only simulations meeting minimum performance standards are considered. </p>
<p>This makes the function a <strong>useful tool for tuning models when the best settings are not known in advance</strong>.</p>
<p><img alt="new_ga workflow" src="../images/new_ga_workflow.svg" /></p>
<h4 id="function-description">Function description<a class="headerlink" href="#function-description" title="Permanent link">&para;</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="8:3"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Initialisation</label><label for="__tabbed_8_2">Inputs</label><label for="__tabbed_8_3">Outputs</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The first time you run <code>new_ga</code>, it automatically creates a new Excel file in your project folder at <strong>"07_ga_search_constraints/_ga_all_inputs.xlsx"</strong>. This file includes three sheets that define the full set of constraints the genetic algorithm will use to search for the optimal solution to your modeling problem.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:3"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Test_Variables</label><label for="__tabbed_9_2">Scoring_Criteria</label><label for="__tabbed_9_3">Selection_Rules</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The Test_Variables sheet controls how each raw variable from Variable.csv is used by the Genetic Algorithm (GA). Each row represents a single original variable and specifies:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Column</th>
<th style="text-align: left;">Populate From / Allowed Values</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Orig_Variable</strong></td>
<td style="text-align: left;">The exact variable name as it appears in <code>Variable.csv</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Variable_Group</strong></td>
<td style="text-align: left;">Use the grouping column from <code>Variable.csv</code> to assign this variable to one of your pre-defined selection-rule groups.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Include</strong></td>
<td style="text-align: left;">Controls GA inclusion:</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>1</code> = force include</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>0</code> = force exclude</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>test</code> = let GA decide include vs. exclude</td>
</tr>
<tr>
<td style="text-align: left;"><strong>VaryBy</strong></td>
<td style="text-align: left;">Coefficient variation across panels:</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>None</code> = one coefficient for all panels</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>&lt;panel_column_name&gt;</code> = separate coefficients by panel</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>test</code> = GA chooses best approach</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Transform</strong></td>
<td style="text-align: left;">Whether to apply a transformation:</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>Y</code> = use the <code>TransformType</code> defined in <code>Variable.csv</code></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>test</code> = GA will try different transformations</td>
</tr>
<tr>
<td style="text-align: left;"><strong>TransformType</strong></td>
<td style="text-align: left;">One of: <code>lag</code>, <code>log</code>, <code>ma</code>, <code>adstockv3</code>, <code>abc</code>, <code>abcnew</code>, <code>adr</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Lag</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> (e.g. <code>1;4</code> for lags 1–4).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Scale</strong></td>
<td style="text-align: left;"><em>(Optional)</em> reserved for future use—leave blank unless your process documentation specifies otherwise.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Effective</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> defining the “effective window” length.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Recency</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> for the recency parameter.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Decay</strong></td>
<td style="text-align: left;">Two decimals between 0 and 1 separated by <code>;</code> (e.g. <code>0.1;0.5</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Period</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> for periodicity tuning.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Window</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> for the adstock or moving-average window.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Length</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> for adstock length.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Peak</strong></td>
<td style="text-align: left;">Two integers separated by <code>;</code> for the ABC/ADR peak parameter.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>A</strong></td>
<td style="text-align: left;">Constant A for ABC/ADR—always set to <code>1</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>B</strong></td>
<td style="text-align: left;">Three integers separated by <code>;</code>, pre-populated using the IQR of the raw variable (e.g. <code>10;50;100</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>C</strong></td>
<td style="text-align: left;">Two values between –5 and 0 separated by <code>;</code>, pre-populated with <code>-2;-0.5</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Source</strong></td>
<td style="text-align: left;">Populated from <code>Variable.csv</code> (e.g. <code>internal_db</code>, <code>third_party</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>TimeUnit</strong></td>
<td style="text-align: left;">From <code>Variable.csv</code> (e.g. <code>week</code>, <code>month</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>data_structure</strong></td>
<td style="text-align: left;">From <code>Variable.csv</code> (e.g. <code>time-series</code>, <code>cross-sectional</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>exp_perc_contribution</strong></td>
<td style="text-align: left;">Two numbers between –1 and 1 separated by <code>;</code> (–100% to +100%). Pre-populated with <code>-1;1</code> to allow full range.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>refresh_priors</strong></td>
<td style="text-align: left;">- <code>Y</code> = recompute new priors at the midpoint of <code>exp_perc_contribution</code></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">- <code>N</code> = use priors already defined in <code>Variable.csv</code> or your custom-priors file</td>
</tr>
</tbody>
</table>
<h6 id="example-row"><strong>Example Row</strong><a class="headerlink" href="#example-row" title="Permanent link">&para;</a></h6>
<table>
<thead>
<tr>
<th style="text-align: left;">Orig_Variable</th>
<th style="text-align: left;">Variable_Group</th>
<th style="text-align: left;">Include</th>
<th style="text-align: left;">VaryBy</th>
<th style="text-align: left;">Transform</th>
<th style="text-align: left;">TransformType</th>
<th style="text-align: left;">Lag</th>
<th style="text-align: left;">Scale</th>
<th style="text-align: left;">Effective</th>
<th style="text-align: left;">Recency</th>
<th style="text-align: left;">Decay</th>
<th style="text-align: left;">Period</th>
<th style="text-align: left;">Window</th>
<th style="text-align: left;">Length</th>
<th style="text-align: left;">Peak</th>
<th style="text-align: center;">A</th>
<th style="text-align: left;">B</th>
<th style="text-align: left;">C</th>
<th style="text-align: left;">Source</th>
<th style="text-align: left;">TimeUnit</th>
<th style="text-align: left;">data_structure</th>
<th style="text-align: left;">exp_perc_contribution</th>
<th style="text-align: left;">refresh_priors</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">TV_Spend</td>
<td style="text-align: left;">Media</td>
<td style="text-align: left;">test</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">lag</td>
<td style="text-align: left;">1;4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1;8</td>
<td style="text-align: left;">0;5</td>
<td style="text-align: left;">0.1;0.5</td>
<td style="text-align: left;">1;3</td>
<td style="text-align: left;">1;4</td>
<td style="text-align: left;">1;4</td>
<td style="text-align: left;">2;6</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">10;50;100</td>
<td style="text-align: left;">-2;-0.5</td>
<td style="text-align: left;">Variable.csv</td>
<td style="text-align: left;">week</td>
<td style="text-align: left;">time-series</td>
<td style="text-align: left;">-1;1</td>
<td style="text-align: left;">Y</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p>The Scoring_Criteria sheet controls how each simulation is evaluated. By setting weights through the importance column, you can guide the GA to prioritize one or multiple performance metrics, adapting the optimization to your analysis goals. </p>
<p>This makes it easy to tailor the scoring logic to different project needs—whether you want to maximize model fit, enforce business constraints, or balance multiple objectives simultaneously.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Field</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Example</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>metric</strong></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The name of the metric.</td>
<td style="text-align: left;"><code>"R2"</code></td>
<td style="text-align: left;">Not editable</td>
</tr>
<tr>
<td style="text-align: left;"><strong>metric_type</strong></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">A human-readable category or description of the metric.</td>
<td style="text-align: left;"><code>"Model fit quality (adjusted R2)"</code></td>
<td style="text-align: left;">Not editable</td>
</tr>
<tr>
<td style="text-align: left;"><strong>panel</strong></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Identifier for the panel or segment this metric belongs to.</td>
<td style="text-align: left;"><code>"region_1"</code></td>
<td style="text-align: left;">Not editable</td>
</tr>
<tr>
<td style="text-align: left;"><strong>threshold_min</strong></td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">The lower bound of the “acceptable” range for the metric.</td>
<td style="text-align: left;"><code>0.9</code></td>
<td style="text-align: left;">Nullable; min ≤ max</td>
</tr>
<tr>
<td style="text-align: left;"><strong>threshold_max</strong></td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">The upper bound of the “acceptable” range for the metric.</td>
<td style="text-align: left;"><code>1</code></td>
<td style="text-align: left;">Nullable; ≥ min</td>
</tr>
<tr>
<td style="text-align: left;"><strong>importance_raw</strong></td>
<td style="text-align: left;">number</td>
<td style="text-align: left;">Raw importance score (unitless).</td>
<td style="text-align: left;"><code>5</code></td>
<td style="text-align: left;">≥ 0</td>
</tr>
<tr>
<td style="text-align: left;"><strong>importance_pct</strong></td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">Importance as a percentage of the total (0–1).</td>
<td style="text-align: left;"><code>0.1667</code></td>
<td style="text-align: left;">Calculation; not editable</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p>The Selection_Rules sheet is optional and helps filter out simulations that don't meet specific criteria. </p>
<p>For instance, if you're testing five price variables but want the final model to include only one of them, you can use this sheet to define minimum and maximum limits for how many variables from the same group can be included. This ensures the algorithm respects structural or business constraints during optimization.</p>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<p>To use this function, the user must provide:</p>
<ul>
<li>Basic numeric settings for the genetic algorithm (e.g., population size, generations, seed).</li>
<li>Logical flags to control simulation filtering and behavior.</li>
<li>Optional numeric thresholds for contribution filtering and performance.</li>
</ul>
</div>
<div class="tabbed-block">
<p>The function returns a list containing several elements that summarize the results of the genetic algorithm optimization.</p>
<p>The <code>sim_summary</code> is a data frame that provides an overview of all simulations along with their corresponding scores, allowing users to compare overall performance. </p>
<p>The <code>sim_specs</code> element is a list detailing the specific parameter configurations used in each simulation. </p>
<p>For a deeper evaluation, <code>sim_scores</code> contains a data frame with more granular scoring information for each run. </p>
<p>The output also includes <code>sim_priors</code>, which lists any prior constraints applied during the optimization, and <code>original_constraints</code>, a data frame capturing the initial set of modeling constraints. </p>
<p>Finally, the <code>seed</code> value used during the run is returned to ensure reproducibility.</p>
</div>
</div>
</div>
<h5 id="tips-reminders"><strong>Tips &amp; Reminders</strong><a class="headerlink" href="#tips-reminders" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Semicolon (<code>;</code>)</strong> is the universal separator for all ranges.</li>
<li><strong>Scale</strong> is blank by default—only populate if your workflow explicitly requires it.</li>
<li>Verify that every <code>TransformType</code> you use is implemented in your GA engine.</li>
<li>Double-check your <code>Variable_Group</code> names against the <code>Selection_Rules</code> tab to avoid typos.</li>
<li>Use this spec as your master document; apply your corporate styles (fonts, numbering, branding) as needed.</li>
</ul>
<h3 id="unnesting-models">Unnesting Models<a class="headerlink" href="#unnesting-models" title="Permanent link">&para;</a></h3>
<p>Unnesting refers to breaking down complex models into simpler, more manageable parts. This is useful when analyzing submodels or when you want to examine the components of a hierarchical structure.</p>
<h4 id="purpose-and-when-to-use">Purpose and When to Use<a class="headerlink" href="#purpose-and-when-to-use" title="Permanent link">&para;</a></h4>
<p>Unnesting is helpful when you need to isolate the effects of individual components in a nested model.</p>
<h2 id="training-materials">Training Materials<a class="headerlink" href="#training-materials" title="Permanent link">&para;</a></h2>
<p>The <code>msmp.emea</code> package provides training materials to help you get familiar with the workflow and the features of the package. These materials are automatically downloaded and set up in a dedicated folder on your machine when you run the <code>install_training()</code> function.</p>
<h3 id="running-install_training">Running <code>install_training()</code><a class="headerlink" href="#running-install_training" title="Permanent link">&para;</a></h3>
<p>After installing <code>msmp.emea</code>, you can access the training materials by running the following command in your RStudio console:</p>
<div class="highlight"><pre><span></span><code>msmp.emea::install_training()
</code></pre></div>
<p>This will create a folder containing the training materials, including documents, data files, and examples to help you practice and understand how to use the package.</p>
<h3 id="training-folder-structure">Training Folder Structure<a class="headerlink" href="#training-folder-structure" title="Permanent link">&para;</a></h3>
<p>Once you’ve run the <code>install_training()</code> function, a new folder will be created with the necessary materials. This folder includes:</p>
<ul>
<li><strong>Guides</strong>: Documentation and guides on the various steps involved in the MMM process.</li>
<li><strong>Data</strong>: Example datasets that you can use for practice.</li>
<li><strong>Modules</strong>: Example scripts that demonstrate the usage of <code>msmp.emea</code> functions.</li>
</ul>
<p>Make sure to explore these materials, as they will serve as a foundation for understanding the full capabilities of the package.</p>
<h2 id="troubleshooting_1">Troubleshooting<a class="headerlink" href="#troubleshooting_1" title="Permanent link">&para;</a></h2>
<h3 id="platform-specific-notes-windows-vs-macos">Platform-Specific Notes (Windows vs macOS)<a class="headerlink" href="#platform-specific-notes-windows-vs-macos" title="Permanent link">&para;</a></h3>
<p>While the workflow is designed to work seamlessly on both Windows and macOS, there might be some system-specific configurations that you need to be aware of. For example, Windows users may need to include specific commands to manage file paths or dependencies. If you encounter any issues, check the documentation or reach out for support.</p>
<h3 id="common-pitfalls">Common Pitfalls<a class="headerlink" href="#common-pitfalls" title="Permanent link">&para;</a></h3>
<p>(placeholder)</p>
<h3 id="reporting-issues">Reporting Issues<a class="headerlink" href="#reporting-issues" title="Permanent link">&para;</a></h3>
<p>If you encounter any bugs or issues with the documentation, please reach out so that we can address them in future updates.</p>
<h2 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h2>
<p>For help with functions, you can use R's built-in help system. For example:</p>
<p>To get detailed documentation for a function, use:</p>
<div class="highlight"><pre><span></span><code>??msmp.emea::function_name
</code></pre></div>
<p>This will open the help page for the specified function.</p>
<h2 id="final-notes">Final Notes<a class="headerlink" href="#final-notes" title="Permanent link">&para;</a></h2>
<p>(placeholder)</p>
<h4 id="process-steps">Process Steps<a class="headerlink" href="#process-steps" title="Permanent link">&para;</a></h4>
<p>(placeholder)</p>
<h4 id="run-model_1">Run Model<a class="headerlink" href="#run-model_1" title="Permanent link">&para;</a></h4>
<p>After setting up your input files and transformations, you can run the model using the predefined functions in the package. The results will include key parameters such as coefficients for each marketing channel and insights into their effectiveness.</p>
<h4 id="understanding-output">Understanding Output<a class="headerlink" href="#understanding-output" title="Permanent link">&para;</a></h4>
<p>The output from the model will include detailed information on the contribution of each channel, as well as response curves that illustrate how different levels of spend impact outcomes.</p>
<h4 id="response-curves_1">Response Curves<a class="headerlink" href="#response-curves_1" title="Permanent link">&para;</a></h4>
<p>Response curves are crucial for understanding how marketing spend translates into outcomes such as sales or revenue. These curves model diminishing returns, helping you optimize your spend by showing the point where increasing spend no longer generates proportionate returns.</p>
<h4 id="fitting-abc-curves">Fitting ABC Curves<a class="headerlink" href="#fitting-abc-curves" title="Permanent link">&para;</a></h4>
<p>The ABC curve is often used to model diminishing returns in marketing. By fitting this curve to the data, you can understand how increasing spend on a given marketing channel will impact the return on investment.</p>
<h4 id="channel-optimization">Channel Optimization<a class="headerlink" href="#channel-optimization" title="Permanent link">&para;</a></h4>
<p>(placeholder)</p>
<p>The <code>03_settings</code> folder, for instance, contains key files such as:</p>
<ul>
<li><strong>Model Setup</strong>: Contains parameters to define the model type and analysis period.</li>
<li><strong>Variables</strong>: Lists all the variables used in your model and their corresponding transformations.</li>
<li><strong>Fit Curves</strong>: Stores the results of fitting response curves to your data.</li>
</ul>
<p>This structure ensures that you don’t need to manually manage the files, making it easier to focus on analysis.</p>
<h2 id="hd-mmm-section">HD MMM Section<a class="headerlink" href="#hd-mmm-section" title="Permanent link">&para;</a></h2>
<h2 id="introduction_1">Introduction<a class="headerlink" href="#introduction_1" title="Permanent link">&para;</a></h2>
<p>This document serves as a guide to help users run HD MMM projects using the <code>msmp.emea</code> package. This document and the codebase are maintained by the Annalect EMEA team, feel free to reach out to the team on any questions you have.</p>
<p>The flowchart below outlines a high level overview of how a HD project will look like.</p>
<p><img alt="HD Flowchart" src="../images/photo_hd_flowcharts.png" /></p>
<h2 id="pre-requisites">Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permanent link">&para;</a></h2>
<p>Before going into the project setup, there are a few pre-requisites that we would like to outline:</p>
<ol>
<li>
<p>Have the latest package version of <code>msmp.emea</code> installed. Link to the repo can be found here: <a href="https://bitbucket.org/omguk-annalect/msmp.emea/src/master/">msmp.emea</a></p>
</li>
<li>
<p>An MMM model. HD is a build on top of MMM so it requires an already established MMM model. Do note that the codebase requires the user to create the MMM models within the <code>msmp.emea</code> environment. If your MMM models are built using another solution, do reach out to a member of the team to discuss the best way forward.</p>
</li>
<li>
<p>Media data splits. Having good data is central to a HD model's success. HD integrates this information by incorporating two additional files on top of the already established MMM model - HD template and HD meta files (See examples below). Both files can be created from the media data using the <code>msmp.emea::process_hd_data()</code> function within the package.</p>
</li>
</ol>
<table align="center">
<tr><th> Example of a HD template table </th><th style="width: 50px;"></th><th> Example of a HD meta table </th></tr>
<tr><td>

    <table>
      <thead>
        <tr>
          <th style="text-align:center;">Orig_Variable</th>
          <th style="text-align:center;">Next_Level_Down</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align:center;">tv_grps</td>
          <td style="text-align:center;"></td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_tactical_grps</td>
          <td style="text-align:center;">tv_grps</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_brand_grps</td>
          <td style="text-align:center;">tv_grps</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_tactical_puba_grps</td>
          <td style="text-align:center;">tv_tactical_grps</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_tactical_pubb_grps</td>
          <td style="text-align:center;">tv_tactical_grps</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_brand_pubb_grps</td>
          <td style="text-align:center;">tv_brand_grps</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_brand_pubc_grps</td>
          <td style="text-align:center;">tv_brand_grps</td>
        </tr>
      </tbody>
    </table>

</td><td>
</td><td>

    <table>
      <thead>
        <tr>
          <th style="text-align:center;">Orig_Variable</th>
          <th style="text-align:center;">Group1</th>
          <th style="text-align:center;">Group2</th>
          <th style="text-align:center;">Group3</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align:center;">tv_tactical_puba_grps</td>
          <td style="text-align:center;">TV</td>
          <td style="text-align:center;">Tactical</td>
          <td style="text-align:center;">PubA</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_tactical_pubb_grps</td>
          <td style="text-align:center;">TV</td>
          <td style="text-align:center;">Tactical</td>
          <td style="text-align:center;">PubA</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_brand_pubb_grps</td>
          <td style="text-align:center;">TV</td>
          <td style="text-align:center;">Brand</td>
          <td style="text-align:center;">PubB</td>
        </tr>
        <tr>
          <td style="text-align:center;">tv_brand_pubc_grps</td>
          <td style="text-align:center;">TV</td>
          <td style="text-align:center;">Brand</td>
          <td style="text-align:center;">PubC</td>
        </tr>
      </tbody>
    </table>

</td></tr> </table>

<hr />
<h2 id="project-setup">Project Setup<a class="headerlink" href="#project-setup" title="Permanent link">&para;</a></h2>
<p>In this section, we will walk through the setup of a HD model using the RMarkdown template in detail. This guide will cover each step in the Rmd template and explain what it is trying to achieve.</p>
<ol>
<li>
<p>Initial HD project setup</p>
<ol>
<li>Intialise the Rmd file<ul>
<li>With the <code>msmp.emea</code> package installed, you should be able to see a HD MMM RMarkdown template. Initialise this file within your project folder. Save this file in the same location as your MMM model Rmd. You can create a template from RStudio by following the instruction below.</li>
<li>
<blockquote>
<p>File -&gt; New File -&gt; R Markdown... -&gt; From Template -&gt; HD-mmm -&gt; Ok</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Define Yaml Parameters</p>
<ul>
<li>Start by defining Yaml parameters at the top of the file. Ensure all parameters are accurate, particularly <code>mmm_model_id</code>, which must match the corresponding entry in the <code>table_of_model_ids.csv</code></li>
<li>
<div class="highlight"><pre><span></span><code>---
title: &quot;Project Title&quot;
author: &quot;Your name&quot;
date: &quot;Date&quot;
params:
  model_client: &quot;client_name&quot;
  model_product: &quot;product1&quot;
  model_region: &quot;country&quot; 
  model_year: &quot;2023&quot;
  model_version: &quot;1.0&quot;
  model_kpi: &quot;my_kpi&quot;
  model_panel: FALSE
  mmm_model_id: &quot;Your MMM model ID&quot;
  hd_model_version: &quot;v_1.0&quot;
---
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Set Date Ranges</p>
<ul>
<li>Define the transform and modelling date ranges of your HD model. These date ranges will need to be the same as your MMM model as HD is very sensitive to this.</li>
<li>For example, you can have a case where your transform start date is a month earlier than your actual model start date to take into account for media adstocks.</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Setting Up and Loading in Data</p>
<ol>
<li>
<p>Run Initialization</p>
<ul>
<li>Execute the <code>hd_mmm_init()</code> function to generate the folder structure required for the project.</li>
<li>Based on the parameters in the Yaml file, it will create a folder called <code>07_hd_mmm</code> at <code>{model_client}_{model_year}/{model_region}_{model_product}_{model_kpi}/{model_version}</code></li>
</ul>
</li>
<li>
<p>Populate the required files for the project</p>
<ul>
<li><strong>HD Variables</strong>: The <code>07_hd_mmm/01_hd_settings/01_input_hd_variables</code> folder will be auto-populated with the Variables.csv file from the MMM model output folder. The user need only check the csv file such that all HD media variables have the labels at "AggregateVariable" column set to "Media" and "Simulate" column set to "Y".</li>
<li><strong>HD Template</strong>: User will need to copy the hd template csv file into the folder <code>07_hd_mmm/01_hd_settings/02_input_hd_template</code>. </li>
<li><strong>HD Meta</strong>: User will need to copy the hd meta csv file into the folder <code>07_hd_mmm/01_hd_settings/03_input_meta</code>. </li>
<li><strong>HD Data</strong> (Optional): If HD level data is already supplied at the MMM stage, there is nothing to do here. Otherwise, user will need to populate the folder <code>07_hd_mmm/01_hd_settings/04_input_hd_data</code> with the relevant csv files.</li>
</ul>
</li>
<li>
<p>Re-run the initialisation function</p>
<ul>
<li>Once the previous step has been completed. Re-run the <code>hd_mmm_init()</code> function.</li>
<li>If successful, you should be able to see 3 new files in the <code>07_hd_mmm/01_hd_settings</code> folder.<ul>
<li><code>{mmm_model_id}_HDModObj.RData</code>: A copy of your model object</li>
<li><code>{mmm_model_id}_HDVariables.csv</code>: HD variables csv file, it contains all the information on variables in the model and any HD level variables</li>
<li><code>{mmm_model_id}_Meta.csv</code>: HD meta file</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Setup HD Variables, Meta and Weights file</p>
<ol>
<li>
<p>At this stage, we should already have most of the HD files setup. The crucial step in this chunk is to make sure that the <code>PreWeights</code> for each HD variables are populated correctly. To facilitate this, user should use the <code>update_hd_preweights()</code> function to update the preweights accordingly. For any media variables that cannot be auto-populated by the function, the user can use the <code>vars</code> and <code>preweights</code> argument to populate them manually.</p>
</li>
<li>
<p>The key thing to keep in mind is that all HD media variables should be in the same scale (i.e. all HD variables are impressions metric or all are in clicks metrics or roughly in the same ballpark in terms of representative size) due to the weight optimization algorithm which rescales these variables.</p>
</li>
<li>
<p>If this chunk ran successfully, you should be able to see a new file in the <code>07_hd_mmm/01_hd_settings</code> folder.</p>
<ul>
<li><code>{mmm_model_id}_Weights.csv</code>: HD weights file, this file is where user will provide information on the HD weights (This file will open once the chunk runs successfully)</li>
</ul>
</li>
<li>
<p>Next step for the user will be to update the Weights file</p>
<ul>
<li>User will need to update the <code>Lower_Weight</code> and <code>Upper_Weight</code> columns which corresponds to your HD variables. A common initial bounds to use is [0.7,1.3]. (An example is shown below)</li>
<li>
<p>Here is a brief explanation of what each column of the file means:</p>
<ul>
<li><strong>Group</strong> &amp; <strong>Value</strong>: These column corresponds to the group and group names of all variables from the meta file. <code>Group1</code> corresponds to your MMM level variables whereas the subsequent groups <code>Group2</code>, <code>Group3</code>, etc. corresponds to the HD level groupings.</li>
<li><strong>Weight</strong>: Weight assigned to the group, bigger number means bigger importance. All weights are initialised to be 1. Weight of 1s for all groups will give you the same results as your MMM model.</li>
<li><strong>Lower_Weight</strong> &amp; <strong>Upper_Weight</strong>: Lower and upper bound of the weights that you allow the algorithm to explore. You should only set Lower and Upper weights for HD groups, i.e. all <code>Group1</code>, <code>Intercept</code>, <code>Dependent</code>, and <code>Base</code> values should be fixed at 1.</li>
<li><strong>Uncontrolled_Weight</strong>: You can ignore this column as this will be populated when we run the weights optimization algorithm.</li>
<li>Example of a weights table:</li>
</ul>
<table>
<thead>
<tr>
<th>Group</th>
<th>Value</th>
<th>Weight</th>
<th>Lower_Weight</th>
<th>Upper_Weight</th>
<th>Uncontrolled_Weight</th>
</tr>
</thead>
<tbody>
<tr>
<td>Group1</td>
<td>Intercept1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Group1</td>
<td>Base1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Group1</td>
<td>Dependent1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Group1</td>
<td>Display</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Group1</td>
<td>YouTube</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Group2</td>
<td>Direct</td>
<td>1</td>
<td>0.7</td>
<td>1.3</td>
<td>1</td>
</tr>
<tr>
<td>Group2</td>
<td>Programmatic</td>
<td>1</td>
<td>0.7</td>
<td>1.3</td>
<td>1</td>
</tr>
<tr>
<td>Group3</td>
<td>Home</td>
<td>1</td>
<td>0.7</td>
<td>1.3</td>
<td>1</td>
</tr>
<tr>
<td>Group3</td>
<td>Technology</td>
<td>1</td>
<td>0.7</td>
<td>1.3</td>
<td>1</td>
</tr>
<tr>
<td>Group3</td>
<td>Fashion</td>
<td>1</td>
<td>0.7</td>
<td>1.3</td>
<td>1</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Update the weights file and run a series of pre-transformation checks</p>
<ol>
<li>In this chunk, the functions will run a series of checks on the HD spec and control files (meta and weights file) to detect any errors or flag any warnings.</li>
</ol>
</li>
<li>
<p>Run Checks and Create Variable Transformations + Weightings for HD MMM</p>
<ol>
<li>At this stage we are almost done with the HD setups and will be able to run the optimization algorithm soon. One last step that we need to do is to check whether we are able to recreate the MMM model outputs from our HD setup. This is an important step as it gives us confidence that we have set HD up for success.</li>
<li>Let's go through some of the key functions in this chunk:<ul>
<li><code>HD_Variable_Tranformations()</code>: HD version of Transform()</li>
<li><code>Distribute_Weights()</code>: Apply weights from the weights file to the HD variables. At this stage all weights should be 1 (Unless the user has provided a different set of weights to initalise HD)</li>
<li><code>Measures_of_Extreme_Transformations()</code>: Gives information on how shape of the adstocks and diminishing returns transformations. An example is shown below
<table>
    <tr>
        <td align="center">
            <img alt="Extremity Adstock" src="../images/photo_hd_extreme_ads.png" />
            <br>
            Example for adstock extremity.
        </td>
        <td align="center">
            <img alt="Extremity DR" src="../images/photo_hd_extreme_dr.png" />
            Example for DR extremity.
        </td>
    </tr>
</table></li>
<li><code>hd_update_priors()</code>: Updates the priors of the model as the HD variables are in a different scale from the MMM model</li>
<li><code>Decomposition_Levels()</code>: HD version of Decomp()</li>
</ul>
</li>
<li>This chunk should run fine without needing any edits to the code. Once the chunk runs, it should create two comparison tables - a decomposition table comparison and a coefficients table comparison.<ul>
<li>Decompoistion table comparison: This is what is important. We should see minimal differences between the two decomps.</li>
<li>Coefficient table comparison: We can see that the HD model's coefficients for media variables look different from their MMM counterpart. This is because of the scaling that is applied to those variables which will be important in the optimization algorithm.</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Weights Optimization
    There are two stages when it comes to optimization of HD weights. First, the algorithm will search for the best possible weights within the bounds specified. After that, a fine tuning algorithm will be run to penalize weights that are not contributing significantly. The idea behind penalizing weights is similar to that of a Lasso or Ridge regression. Similar to how a penalized coefficient will be pulled towards 0, in this case, a penalized weight will be pulled back towards 1. We have broken down this stage into 3 sections: (1) Establishing a rough range the optimal penalty might sit in, (2) Do a grid search of the penalty range, (3) Run the optimization algorithm with the optimal penalty value</p>
<ol>
<li>
<p>Uncontrolled weights and penalty range</p>
<ul>
<li>In this chunk, we are looking to understand the range of penalty values that we should test for the model. When we run the optimization algorithm with <code>UCOpt</code> set to TRUE, we can see a suggested penalty range printed in the console.</li>
</ul>
<div class="highlight"><pre><span></span><code>Set the penalty for optimization somewhere between 65.2 and 2693.4 for this data.
  With a penalty of 271.9 preventing only the worst over-fitting but has very high R-Squared.
  A penalty of 753.8 a good average amount of control.
  And a penalty of 936.5 allows only the most statistically significant weights. 
</code></pre></div>
<ul>
<li>Besides that, the uncontrolled weights will also give us an idea of whether the bounds we set for our groups are sufficient. For example, if the uncontrolled weight of a group goes beyond its upper or lower bound, it is advised to widen the bound.<ol>
<li>Testing penalty values</li>
</ol>
</li>
<li>Once we have the initial penalty values that we can be testing, we can input them into the <code>penalty_vals</code> vector and run the chunk to test out these values. The chunk willl take a while to run, and once finished, it will create a folder called <code>hd_penalty_loop_outputs</code> in the main folder and output the results in an excel file. We will talk more about analysing this output in the next section.</li>
<li>This is an iterative process, which means we will need to run this chunk multiple times until we find a good penalty value that works well with the model. For example, I have tested penalty values [10, 20, 50, 75, 100] and have found that 20 seems to be giving me the most optimal result. Next, I will test the penalty values [15, 18, 21, 25, 30] to determine which values in the vicinity of 20 gives me a better result. As you can see, it can take quite a few tries to get to our final penalty value.</li>
<li>Do note that optimal penalty value may vary from one group to another, so it is important to balance this as we can only have one penalty value in the end.<ol>
<li>Run optimization with optimal penalty value</li>
</ol>
</li>
<li>After testing all the penalty values and have found the one that is suitable for our model, input that value into the weights optimization function to create our final output.</li>
<li>With this, we should have everything we need - Final HD Weights, HD Decomp table, and HD Response Curves. All that we need to do now is save the output.</li>
</ul>
</li>
</ol>
</li>
</ol>
<hr />
<h2 id="analyzing-hd-outputs">Analyzing HD Outputs<a class="headerlink" href="#analyzing-hd-outputs" title="Permanent link">&para;</a></h2>
<p>This section aims to breakdown the excel file output generated from the penalties testing stage. In the file, you will see 4 sheets:</p>
<ol>
<li>
<p><strong>RanWeights</strong></p>
<ul>
<li>As you can see, this sheet resembles the weights file quite a bit, with a few additional columns. It displays the random weights that we get from the optimization algorithm. If you recall, the optimization algorithm runs in two stages, it first gets the best weight in the range, then it refines the weights using the penalty value. Random weights are the weights we get from the first stage of the optimization (best weights in the range). Therefore, these weights are optimized <strong>without</strong> the use of penalty values. You can think of these weights as weights we get from a penalty of 0.</li>
<li>Purpose: To understand whether the algorithm is giving us consistent results across each run. This is very important as it tells us that the algorithm has converged. However, when we see inconsistencies between runs, the user have to dive into why this is the case. There are a few explanation as to why the weights may not have converged:<ul>
<li>Size of the group is too small (inidicated by the size column). When the size is too small, the choice of giving it a weight close to the upper bound or the lower bound yields insignificant change to the model. In this case, user can choose not to weight them at all (set lower and upper bounds to 1).</li>
<li>Run time is too short. When the search range is large or there are many groups in a level, the search space is big and the algorithm hasn't had the chance to explore a good chunk of the parameter space. In this case, it will be wise to increase the run time.</li>
<li>In cases where the groups are very big and relationship between groups are complex. It is sufficient to observe whether the weights are telling a consistent story, e.g. Group X in Level 2 consistently outperforms the other groups in the same level although it takes on different values in each run.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Weights</strong></p>
<ul>
<li>This sheet is very similar to the <strong>RanWeights</strong> sheet, with a slight difference whereby instead of random weights, these weights are the fine tuned version of random weights (weights we get from the second stage of the optimization algorithm). Therefore, these weights are heavily influenced by the penalty values.</li>
<li>Purpose: Look for consistencies across different runs <strong>within</strong> the same penalty value. Choosing the best penalty value will be up to the analyst's judgement. However, do keep in mind that the weights should be reasonable and tell us a meaningful story. (e.g., A set of weights of 1s as our output isn't telling us anything new as these are the default results we get from our MMM model)</li>
</ul>
</li>
<li>
<p><strong>Effect</strong></p>
<ul>
<li>You can think of effect as a value showing how significant the group is at increasing the model's performance when it's weight is increased/ decreased by a small step in either direction. The bigger the value, the more significant the group is.</li>
</ul>
</li>
<li>
<p><strong>Decomp</strong></p>
<ul>
<li>As looking at the decomposition table is an important factor while deciding on penalty values, its corresponding decomp table of each weights optimization run is saved here so the user can always refer to it when needed.</li>
</ul>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>